<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<meta name="GENERATOR" content="TtH 3.67">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>


<title> Programming in R</title>
 
<h1 align="center">Programming in R </h1>



     <h2><a name="tth_sEc1">
1</a>&nbsp;&nbsp;Operating on Groups of Data</h2>
We've already seen how the <tt>aggregate</tt> function let's us
calculate data summaries for groups in our  data.  For example,
using the <tt>world</tt> data set, we could find the average 
value of each variable, broken down by continent:

<pre>
&#62;&nbsp;world&nbsp;=&nbsp;read.csv('http://www.stat.berkeley.edu/classes/s133/data/world2.txt',na.strings='.',comment='#')
&#62;&nbsp;&#62;&nbsp;names(world)
[1]&nbsp;"country"&nbsp;&nbsp;"cont"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"gdp"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"income"&nbsp;&nbsp;&nbsp;"literacy"&nbsp;"military"&nbsp;"phys"&nbsp;&nbsp;&nbsp;&nbsp;
[8]&nbsp;"un.date"&nbsp;
&#62;&nbsp;aggregate(world[,-c(1,2,8)],world['cont'],mean,na.rm=TRUE)
&nbsp;&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gdp&nbsp;&nbsp;&nbsp;&nbsp;income&nbsp;literacy&nbsp;&nbsp;&nbsp;&nbsp;military&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phys
1&nbsp;&nbsp;&nbsp;AF&nbsp;&nbsp;2723.404&nbsp;&nbsp;3901.191&nbsp;60.52979&nbsp;&nbsp;&nbsp;356440000&nbsp;&nbsp;26.31129
2&nbsp;&nbsp;&nbsp;AS&nbsp;&nbsp;7778.049&nbsp;&nbsp;8868.098&nbsp;84.25122&nbsp;&nbsp;5006536341&nbsp;161.83381
3&nbsp;&nbsp;&nbsp;EU&nbsp;19711.765&nbsp;21314.324&nbsp;98.40294&nbsp;&nbsp;6311138235&nbsp;311.18482
4&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;8946.667&nbsp;10379.143&nbsp;85.52000&nbsp;25919931267&nbsp;187.08178
5&nbsp;&nbsp;&nbsp;OC&nbsp;14625.000&nbsp;15547.500&nbsp;87.50000&nbsp;&nbsp;4462475000&nbsp;127.63105
6&nbsp;&nbsp;&nbsp;SA&nbsp;&nbsp;6283.333&nbsp;&nbsp;6673.083&nbsp;92.29167&nbsp;&nbsp;2137341667&nbsp;154.81088

</pre>
Since the <tt>aggregate</tt> function requires the grouping variables to
be in a list, I took advantage of the fact that data frames are also
lists, and passed a single element (using single brackets) to 
<tt>aggregate</tt>.  Alternatively, I could have used a list directly:

<pre>
&#62;&nbsp;aggregate(world[,-c(1,2,8)],list(world$cont),mean,na.rm=TRUE)
&nbsp;&nbsp;Group.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gdp&nbsp;&nbsp;&nbsp;&nbsp;income&nbsp;literacy&nbsp;&nbsp;&nbsp;&nbsp;military&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phys
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AF&nbsp;&nbsp;2723.404&nbsp;&nbsp;3901.191&nbsp;60.52979&nbsp;&nbsp;&nbsp;356440000&nbsp;&nbsp;26.31129
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;&nbsp;7778.049&nbsp;&nbsp;8868.098&nbsp;84.25122&nbsp;&nbsp;5006536341&nbsp;161.83381
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU&nbsp;19711.765&nbsp;21314.324&nbsp;98.40294&nbsp;&nbsp;6311138235&nbsp;311.18482
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;8946.667&nbsp;10379.143&nbsp;85.52000&nbsp;25919931267&nbsp;187.08178
5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OC&nbsp;14625.000&nbsp;15547.500&nbsp;87.50000&nbsp;&nbsp;4462475000&nbsp;127.63105
6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SA&nbsp;&nbsp;6283.333&nbsp;&nbsp;6673.083&nbsp;92.29167&nbsp;&nbsp;2137341667&nbsp;154.81088

</pre>
I would need to name the list element in order for its column in 
the output to be properly labeled.

<div class="p"><!----></div>
Now suppose I'd like to calculate both the mean and the median for
each continent:

<pre>
&#62;&nbsp;answer&nbsp;=&nbsp;aggregate(world[,-c(1,2,8)],world['cont'],function(x)c(mean(x,na.rm=TRUE),median(x,na.rm=TRUE)))
&#62;&nbsp;answer
&nbsp;&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gdp.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gdp.2&nbsp;&nbsp;income.1&nbsp;&nbsp;income.2&nbsp;literacy.1&nbsp;literacy.2
1&nbsp;&nbsp;&nbsp;AF&nbsp;&nbsp;2723.404&nbsp;&nbsp;1400.000&nbsp;&nbsp;3901.191&nbsp;&nbsp;1813.000&nbsp;&nbsp;&nbsp;60.52979&nbsp;&nbsp;&nbsp;65.50000
2&nbsp;&nbsp;&nbsp;AS&nbsp;&nbsp;7778.049&nbsp;&nbsp;4300.000&nbsp;&nbsp;8868.098&nbsp;&nbsp;4561.000&nbsp;&nbsp;&nbsp;84.25122&nbsp;&nbsp;&nbsp;89.90000
3&nbsp;&nbsp;&nbsp;EU&nbsp;19711.765&nbsp;18150.000&nbsp;21314.324&nbsp;19804.000&nbsp;&nbsp;&nbsp;98.40294&nbsp;&nbsp;&nbsp;99.70000
4&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;8946.667&nbsp;&nbsp;4900.000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;85.52000&nbsp;&nbsp;&nbsp;87.70000
5&nbsp;&nbsp;&nbsp;OC&nbsp;14625.000&nbsp;13700.000&nbsp;15547.500&nbsp;14970.000&nbsp;&nbsp;&nbsp;87.50000&nbsp;&nbsp;&nbsp;96.40000
6&nbsp;&nbsp;&nbsp;SA&nbsp;&nbsp;6283.333&nbsp;&nbsp;5000.000&nbsp;&nbsp;6673.083&nbsp;&nbsp;5563.500&nbsp;&nbsp;&nbsp;92.29167&nbsp;&nbsp;&nbsp;92.30000
&nbsp;&nbsp;&nbsp;military.1&nbsp;&nbsp;military.2&nbsp;&nbsp;&nbsp;&nbsp;phys.1&nbsp;&nbsp;&nbsp;&nbsp;phys.2
1&nbsp;&nbsp;&nbsp;356440000&nbsp;&nbsp;&nbsp;101300000&nbsp;&nbsp;26.31129&nbsp;&nbsp;&nbsp;8.68680
2&nbsp;&nbsp;5006536341&nbsp;&nbsp;&nbsp;650000000&nbsp;161.83381&nbsp;139.92540
3&nbsp;&nbsp;6311138235&nbsp;&nbsp;1288500000&nbsp;311.18482&nbsp;317.88580
4&nbsp;25919931267&nbsp;&nbsp;&nbsp;147000000&nbsp;187.08178&nbsp;164.40130
5&nbsp;&nbsp;4462475000&nbsp;&nbsp;&nbsp;591500000&nbsp;127.63105&nbsp;128.11915
6&nbsp;&nbsp;2137341667&nbsp;&nbsp;&nbsp;742150000&nbsp;154.81088&nbsp;126.00035

</pre>
  There are eleven columns in the data, but when we look
at the dimensions of the result, things seem strange:

<pre>
&#62;&nbsp;dim(answer)
[1]&nbsp;6&nbsp;6

</pre>
  That's because <tt>aggregate</tt> stores each set of the two
values returned from the function we passed to it in matrices inside
the <tt>answer</tt> data frame:

<pre>
&#62;&nbsp;sapply(answer,class)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gdp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;income&nbsp;&nbsp;&nbsp;&nbsp;literacy&nbsp;&nbsp;&nbsp;&nbsp;military&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phys&nbsp;
"character"&nbsp;&nbsp;&nbsp;&nbsp;"matrix"&nbsp;&nbsp;&nbsp;&nbsp;"matrix"&nbsp;&nbsp;&nbsp;&nbsp;"matrix"&nbsp;&nbsp;&nbsp;&nbsp;"matrix"&nbsp;&nbsp;&nbsp;&nbsp;"matrix"&nbsp;
&#62;&nbsp;names(answer)
[1]&nbsp;"cont"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"gdp"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"income"&nbsp;&nbsp;&nbsp;"literacy"&nbsp;"military"&nbsp;"phys"&nbsp;&nbsp;&nbsp;&nbsp;
&#62;&nbsp;answer[,2]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,1]&nbsp;&nbsp;[,2]
[1,]&nbsp;&nbsp;2723.404&nbsp;&nbsp;1400
[2,]&nbsp;&nbsp;7778.049&nbsp;&nbsp;4300
[3,]&nbsp;19711.765&nbsp;18150
[4,]&nbsp;&nbsp;8946.667&nbsp;&nbsp;4900
[5,]&nbsp;14625.000&nbsp;13700
[6,]&nbsp;&nbsp;6283.333&nbsp;&nbsp;5000

</pre>
  This actually makes it pretty easy to access the values that
we want.  For example, suppose we want the mean for the variable 
<tt>military</tt>.  Since the mean was the first element returned by the 
function we passed to <tt>aggregate</tt>, it's the first column in the 
<tt>military</tt> matrix:

<pre>
&#62;&nbsp;data.frame(answer$cont,military.mean=answer$military[,1])
&nbsp;&nbsp;answer.cont&nbsp;military.mean
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;356440000
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;&nbsp;&nbsp;&nbsp;5006536341
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU&nbsp;&nbsp;&nbsp;&nbsp;6311138235
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;25919931267
5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OC&nbsp;&nbsp;&nbsp;&nbsp;4462475000
6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SA&nbsp;&nbsp;&nbsp;&nbsp;2137341667

</pre>
 The output from <tt>aggregate</tt> is often easier to use 
if we give names to the values calculated by the function we pass to
aggregate.  For example, if we call aggregate like this:

<pre>&nbsp;&nbsp;
&#62;&nbsp;answer&nbsp;=&nbsp;aggregate(world[,-c(1,2,8)],world['cont'],function(x)c(mean=mean(x,na.rm=TRUE),median=median(x,na.rm=TRUE)))
&#62;&nbsp;answer
&nbsp;&nbsp;cont&nbsp;&nbsp;gdp.mean&nbsp;gdp.median&nbsp;income.mean&nbsp;income.median&nbsp;literacy.mean
1&nbsp;&nbsp;&nbsp;AF&nbsp;&nbsp;2723.404&nbsp;&nbsp;&nbsp;1400.000&nbsp;&nbsp;&nbsp;&nbsp;3901.191&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1813.000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;60.52979
2&nbsp;&nbsp;&nbsp;AS&nbsp;&nbsp;7778.049&nbsp;&nbsp;&nbsp;4300.000&nbsp;&nbsp;&nbsp;&nbsp;8868.098&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4561.000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;84.25122
3&nbsp;&nbsp;&nbsp;EU&nbsp;19711.765&nbsp;&nbsp;18150.000&nbsp;&nbsp;&nbsp;21314.324&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;19804.000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;98.40294
4&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;8946.667&nbsp;&nbsp;&nbsp;4900.000&nbsp;&nbsp;&nbsp;10379.143&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6753.000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;85.52000
5&nbsp;&nbsp;&nbsp;OC&nbsp;14625.000&nbsp;&nbsp;13700.000&nbsp;&nbsp;&nbsp;15547.500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14970.000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;87.50000
6&nbsp;&nbsp;&nbsp;SA&nbsp;&nbsp;6283.333&nbsp;&nbsp;&nbsp;5000.000&nbsp;&nbsp;&nbsp;&nbsp;6673.083&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5563.500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;92.29167
&nbsp;&nbsp;literacy.median&nbsp;military.mean&nbsp;military.median&nbsp;phys.mean&nbsp;phys.median
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;65.50000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;356440000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;101300000&nbsp;&nbsp;26.31129&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.68680
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;89.90000&nbsp;&nbsp;&nbsp;&nbsp;5006536341&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;650000000&nbsp;161.83381&nbsp;&nbsp;&nbsp;139.92540
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;99.70000&nbsp;&nbsp;&nbsp;&nbsp;6311138235&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1288500000&nbsp;311.18482&nbsp;&nbsp;&nbsp;317.88580
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;87.70000&nbsp;&nbsp;&nbsp;25919931267&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;147000000&nbsp;187.08178&nbsp;&nbsp;&nbsp;164.40130
5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;96.40000&nbsp;&nbsp;&nbsp;&nbsp;4462475000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;591500000&nbsp;127.63105&nbsp;&nbsp;&nbsp;128.11915
6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;92.30000&nbsp;&nbsp;&nbsp;&nbsp;2137341667&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;742150000&nbsp;154.81088&nbsp;&nbsp;&nbsp;126.00035

</pre>
Now we can say, for example:

<pre>
&#62;&nbsp;data.frame(cont=answer$cont,literacy.median=answer$literacy[,'median'])
&nbsp;&nbsp;cont&nbsp;literacy.median
1&nbsp;&nbsp;&nbsp;AF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;65.5
2&nbsp;&nbsp;&nbsp;AS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;89.9
3&nbsp;&nbsp;&nbsp;EU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;99.7
4&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;87.7
5&nbsp;&nbsp;&nbsp;OC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;96.4
6&nbsp;&nbsp;&nbsp;SA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;92.3

</pre>
  Another way to manage the output from aggregate takes advantage
of the fact that when the <tt>data.frame</tt> function is called with
multiple data frames, it doesn't store the data frames as separate columns,
but rather makes one big data frame with lots of columns.  So if we 
convert each of the matrices to data frames we can combine all of them
into one big data frame:

<pre>
&#62;&nbsp;answer1&nbsp;=&nbsp;data.frame(answer[,1],data.frame(answer[,2]),data.frame(answer[,3]),data.frame(answer[,4]),data.frame(answer[,5]),data.frame(answer[,6]))
&#62;&nbsp;answer1
&nbsp;&nbsp;answer...1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;median&nbsp;&nbsp;&nbsp;&nbsp;mean.1&nbsp;median.1&nbsp;&nbsp;&nbsp;mean.2&nbsp;median.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean.3
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AF&nbsp;&nbsp;2723.404&nbsp;&nbsp;&nbsp;1400&nbsp;&nbsp;3901.191&nbsp;&nbsp;&nbsp;1813.0&nbsp;60.52979&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;65.5&nbsp;&nbsp;&nbsp;356440000
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;&nbsp;7778.049&nbsp;&nbsp;&nbsp;4300&nbsp;&nbsp;8868.098&nbsp;&nbsp;&nbsp;4561.0&nbsp;84.25122&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;89.9&nbsp;&nbsp;5006536341
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU&nbsp;19711.765&nbsp;&nbsp;18150&nbsp;21314.324&nbsp;&nbsp;19804.0&nbsp;98.40294&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;99.7&nbsp;&nbsp;6311138235
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;8946.667&nbsp;&nbsp;&nbsp;4900&nbsp;10379.143&nbsp;&nbsp;&nbsp;6753.0&nbsp;85.52000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;87.7&nbsp;25919931267
5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OC&nbsp;14625.000&nbsp;&nbsp;13700&nbsp;15547.500&nbsp;&nbsp;14970.0&nbsp;87.50000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;96.4&nbsp;&nbsp;4462475000
6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SA&nbsp;&nbsp;6283.333&nbsp;&nbsp;&nbsp;5000&nbsp;&nbsp;6673.083&nbsp;&nbsp;&nbsp;5563.5&nbsp;92.29167&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;92.3&nbsp;&nbsp;2137341667
&nbsp;&nbsp;&nbsp;&nbsp;median.3&nbsp;&nbsp;&nbsp;&nbsp;mean.4&nbsp;median.4
1&nbsp;&nbsp;101300000&nbsp;&nbsp;26.31129&nbsp;&nbsp;&nbsp;8.6868
2&nbsp;&nbsp;650000000&nbsp;161.83381&nbsp;139.9254
3&nbsp;1288500000&nbsp;311.18482&nbsp;317.8858
4&nbsp;&nbsp;147000000&nbsp;187.08178&nbsp;164.4013
5&nbsp;&nbsp;591500000&nbsp;127.63105&nbsp;128.1191
6&nbsp;&nbsp;742150000&nbsp;154.81088&nbsp;126.0003
&#62;&nbsp;dim(answer1)
[1]&nbsp;&nbsp;6&nbsp;11

</pre>
 We'd need to rename the columns, but there are now 
actually eleven columns as we would expect.  Of course, we wouldn't want
to do all that typing in practice.  We would use some of R's powerful
tools to automate the process.  For example, we could try to  use 
<tt>sapply</tt> to
convert all the matrices to data frames

<pre>
&#62;&nbsp;sapply(answer[,-1],data.frame)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gdp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;income&nbsp;&nbsp;&nbsp;&nbsp;literacy&nbsp;&nbsp;military&nbsp;&nbsp;phys&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mean&nbsp;&nbsp;&nbsp;Numeric,6&nbsp;Numeric,6&nbsp;Numeric,6&nbsp;Numeric,6&nbsp;Numeric,6
median&nbsp;Numeric,6&nbsp;Numeric,6&nbsp;Numeric,6&nbsp;Numeric,6&nbsp;Numeric,6

</pre>
 As we've seen before this is usually an indication that
<tt>sapply</tt> has simplified things too much.  If we try 
<tt>lapply</tt>, this is what we get:

<pre>
&#62;&nbsp;lapply(answer[,-1],data.frame)
$gdp
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;median
1&nbsp;&nbsp;2723.404&nbsp;&nbsp;&nbsp;1400
2&nbsp;&nbsp;7778.049&nbsp;&nbsp;&nbsp;4300
3&nbsp;19711.765&nbsp;&nbsp;18150
4&nbsp;&nbsp;8946.667&nbsp;&nbsp;&nbsp;4900
5&nbsp;14625.000&nbsp;&nbsp;13700
6&nbsp;&nbsp;6283.333&nbsp;&nbsp;&nbsp;5000

$income
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;median
1&nbsp;&nbsp;3901.191&nbsp;&nbsp;1813.0
2&nbsp;&nbsp;8868.098&nbsp;&nbsp;4561.0
3&nbsp;21314.324&nbsp;19804.0
4&nbsp;10379.143&nbsp;&nbsp;6753.0
5&nbsp;15547.500&nbsp;14970.0
6&nbsp;&nbsp;6673.083&nbsp;&nbsp;5563.5

</pre>

<div class="p"><!----></div>
We can convert the list to a data frame as follows:

<pre>
&#62;&nbsp;answer1=&nbsp;data.frame(answer[1],lapply(answer[,-1],data.frame))
&#62;&nbsp;answer1
&nbsp;&nbsp;cont&nbsp;&nbsp;gdp.mean&nbsp;gdp.median&nbsp;income.mean&nbsp;income.median&nbsp;literacy.mean
1&nbsp;&nbsp;&nbsp;AF&nbsp;&nbsp;2723.404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1400&nbsp;&nbsp;&nbsp;&nbsp;3901.191&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1813.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;60.52979
2&nbsp;&nbsp;&nbsp;AS&nbsp;&nbsp;7778.049&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4300&nbsp;&nbsp;&nbsp;&nbsp;8868.098&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4561.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;84.25122
3&nbsp;&nbsp;&nbsp;EU&nbsp;19711.765&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18150&nbsp;&nbsp;&nbsp;21314.324&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;19804.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;98.40294
4&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;8946.667&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4900&nbsp;&nbsp;&nbsp;10379.143&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6753.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;85.52000
5&nbsp;&nbsp;&nbsp;OC&nbsp;14625.000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13700&nbsp;&nbsp;&nbsp;15547.500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14970.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;87.50000
6&nbsp;&nbsp;&nbsp;SA&nbsp;&nbsp;6283.333&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5000&nbsp;&nbsp;&nbsp;&nbsp;6673.083&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5563.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;92.29167
&nbsp;&nbsp;literacy.median&nbsp;military.mean&nbsp;military.median&nbsp;phys.mean&nbsp;phys.median
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;65.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;356440000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;101300000&nbsp;&nbsp;26.31129&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.6868
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;89.9&nbsp;&nbsp;&nbsp;&nbsp;5006536341&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;650000000&nbsp;161.83381&nbsp;&nbsp;&nbsp;&nbsp;139.9254
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;99.7&nbsp;&nbsp;&nbsp;&nbsp;6311138235&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1288500000&nbsp;311.18482&nbsp;&nbsp;&nbsp;&nbsp;317.8858
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;87.7&nbsp;&nbsp;&nbsp;25919931267&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;147000000&nbsp;187.08178&nbsp;&nbsp;&nbsp;&nbsp;164.4013
5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;96.4&nbsp;&nbsp;&nbsp;&nbsp;4462475000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;591500000&nbsp;127.63105&nbsp;&nbsp;&nbsp;&nbsp;128.1191
6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;92.3&nbsp;&nbsp;&nbsp;&nbsp;2137341667&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;742150000&nbsp;154.81088&nbsp;&nbsp;&nbsp;&nbsp;126.0003

</pre>
 As is often the case, R takes care of the names more effectively
than if we labouriously combined everything by hand.
All that would be left to make this a truly useful display is to add
the number of countries in each continent.  Since this will be the same
for each variable, it's usually not a good idea to return this value in the
function you pass to aggregate.  Instead, we can use the <tt>table</tt>,
<tt>as.data.frame</tt>, and <tt>merge</tt> functions as follows:

<pre>
&#62;&nbsp;counts&nbsp;=&nbsp;as.data.frame(table(world$cont))
&#62;&nbsp;names(counts)&nbsp;=&nbsp;c('cont','N')
&#62;&nbsp;merge(counts,answer1)
&nbsp;&nbsp;cont&nbsp;&nbsp;N&nbsp;&nbsp;gdp.mean&nbsp;gdp.median&nbsp;income.mean&nbsp;income.median&nbsp;literacy.mean
1&nbsp;&nbsp;&nbsp;AF&nbsp;47&nbsp;&nbsp;2723.404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1400&nbsp;&nbsp;&nbsp;&nbsp;3901.191&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1813.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;60.52979
2&nbsp;&nbsp;&nbsp;AS&nbsp;41&nbsp;&nbsp;7778.049&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4300&nbsp;&nbsp;&nbsp;&nbsp;8868.098&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4561.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;84.25122
3&nbsp;&nbsp;&nbsp;EU&nbsp;34&nbsp;19711.765&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18150&nbsp;&nbsp;&nbsp;21314.324&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;19804.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;98.40294
4&nbsp;&nbsp;&nbsp;NA&nbsp;15&nbsp;&nbsp;8946.667&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4900&nbsp;&nbsp;&nbsp;10379.143&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6753.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;85.52000
5&nbsp;&nbsp;&nbsp;OC&nbsp;&nbsp;4&nbsp;14625.000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13700&nbsp;&nbsp;&nbsp;15547.500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14970.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;87.50000
6&nbsp;&nbsp;&nbsp;SA&nbsp;12&nbsp;&nbsp;6283.333&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5000&nbsp;&nbsp;&nbsp;&nbsp;6673.083&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5563.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;92.29167
&nbsp;&nbsp;literacy.median&nbsp;military.mean&nbsp;military.median&nbsp;phys.mean&nbsp;phys.median
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;65.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;356440000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;101300000&nbsp;&nbsp;26.31129&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.6868
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;89.9&nbsp;&nbsp;&nbsp;&nbsp;5006536341&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;650000000&nbsp;161.83381&nbsp;&nbsp;&nbsp;&nbsp;139.9254
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;99.7&nbsp;&nbsp;&nbsp;&nbsp;6311138235&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1288500000&nbsp;311.18482&nbsp;&nbsp;&nbsp;&nbsp;317.8858
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;87.7&nbsp;&nbsp;&nbsp;25919931267&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;147000000&nbsp;187.08178&nbsp;&nbsp;&nbsp;&nbsp;164.4013
5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;96.4&nbsp;&nbsp;&nbsp;&nbsp;4462475000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;591500000&nbsp;127.63105&nbsp;&nbsp;&nbsp;&nbsp;128.1191
6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;92.3&nbsp;&nbsp;&nbsp;&nbsp;2137341667&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;742150000&nbsp;154.81088&nbsp;&nbsp;&nbsp;&nbsp;126.0003

</pre>

<div class="p"><!----></div>
Even though <tt>aggregate</tt> can handle cases with more than one value
being calculated, it still can only work with one variable at a time.
There are two approaches to solve the cases where you need to work with
more than one variable.
The first, uses the <tt>split</tt> function that we've seen for making 
boxplots.  
Suppose we want to find the two variables with the highest correlation
within each continent.  First, we can write a function that will find
the variables for with the highest correlation in a data frame:

<pre>
hicorr&nbsp;=&nbsp;function(x){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;x[,sapply(x,function(col)mode(col)&nbsp;==&nbsp;'numeric'&nbsp;&amp;&nbsp;class(col)&nbsp;!=&nbsp;'factor')]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cc&nbsp;=&nbsp;cor(x,use='complete.obs')
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diag(cc)&nbsp;=&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wh&nbsp;=&nbsp;which(cc&nbsp;==&nbsp;max(cc),arr.ind=TRUE)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c(rownames(cc)[wh[1]],colnames(cc)[wh[2]])
}

</pre>
 Now we can use <tt>sapply</tt> and <tt>split</tt> to
find the variables with the highest correlation in each continent:

<pre>
&#62;&nbsp;as.data.frame(t(sapply(split(world,world$cont),hicorr)))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V2
AF&nbsp;&nbsp;&nbsp;phys&nbsp;military
AS&nbsp;income&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gdp
EU&nbsp;income&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gdp
NA&nbsp;income&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gdp
OC&nbsp;income&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gdp
SA&nbsp;income&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gdp

</pre>

<div class="p"><!----></div>
The other way to solve problems like this is with the <tt>by</tt>
function.  The <tt>by</tt> function produces nicely formatted output,
but its output can be manipulated if necessary.  Here's the basic
approach for a problem like this.  

<pre>
&#62;&nbsp;byvals&nbsp;=&nbsp;by(world,world$cont,hicorr)
&#62;&nbsp;byvals
world$cont:&nbsp;AF
[1]&nbsp;"phys"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"military"
------------------------------------------------------------&nbsp;
world$cont:&nbsp;AS
[1]&nbsp;"income"&nbsp;"gdp"&nbsp;&nbsp;&nbsp;
------------------------------------------------------------&nbsp;
world$cont:&nbsp;EU
[1]&nbsp;"income"&nbsp;"gdp"&nbsp;&nbsp;&nbsp;
------------------------------------------------------------&nbsp;
world$cont:&nbsp;NA
[1]&nbsp;"income"&nbsp;"gdp"&nbsp;&nbsp;&nbsp;
------------------------------------------------------------&nbsp;
world$cont:&nbsp;OC
[1]&nbsp;"income"&nbsp;"gdp"&nbsp;&nbsp;&nbsp;
------------------------------------------------------------&nbsp;
world$cont:&nbsp;SA
[1]&nbsp;"income"&nbsp;"gdp"&nbsp;&nbsp;&nbsp;

</pre>
Since each piece of the <tt>byvals</tt> object looks like part of
a data frame we want, we can use <tt>do.call</tt> with rbind:

<pre>
&#62;&nbsp;ans&nbsp;=&nbsp;do.call(rbind,byvals)
&#62;&nbsp;ans
&nbsp;&nbsp;&nbsp;[,1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
AF&nbsp;"phys"&nbsp;&nbsp;&nbsp;"military"
AS&nbsp;"income"&nbsp;"gdp"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
EU&nbsp;"income"&nbsp;"gdp"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
NA&nbsp;"income"&nbsp;"gdp"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
OC&nbsp;"income"&nbsp;"gdp"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
SA&nbsp;"income"&nbsp;"gdp"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

</pre>

<div class="p"><!----></div>
As another example of <tt>do.call</tt>,  consider the task of sorting
a data frame by its first column, then using the second column to 
break any ties, and so on for each ofthe columns of the data frame.
For example:

<pre>
&#62;&nbsp;x&nbsp;=&nbsp;data.frame(matrix(sample(1:5,100,replace=TRUE),ncol=5))
&#62;&nbsp;head(x)
&nbsp;&nbsp;X1&nbsp;X2&nbsp;X3&nbsp;X4&nbsp;X5
1&nbsp;&nbsp;4&nbsp;&nbsp;4&nbsp;&nbsp;1&nbsp;&nbsp;3&nbsp;&nbsp;4
2&nbsp;&nbsp;2&nbsp;&nbsp;4&nbsp;&nbsp;2&nbsp;&nbsp;4&nbsp;&nbsp;1
3&nbsp;&nbsp;1&nbsp;&nbsp;1&nbsp;&nbsp;1&nbsp;&nbsp;3&nbsp;&nbsp;2
4&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;2
5&nbsp;&nbsp;5&nbsp;&nbsp;2&nbsp;&nbsp;2&nbsp;&nbsp;4&nbsp;&nbsp;3
6&nbsp;&nbsp;4&nbsp;&nbsp;2&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;5

</pre>
Since a data frame is a list, with each element representing a column,
we can order the data frame as follows:

<pre>
&#62;&nbsp;x[do.call(order,x),]
&nbsp;&nbsp;&nbsp;X1&nbsp;X2&nbsp;X3&nbsp;X4&nbsp;X5
3&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;1&nbsp;&nbsp;1&nbsp;&nbsp;3&nbsp;&nbsp;2
17&nbsp;&nbsp;1&nbsp;&nbsp;2&nbsp;&nbsp;3&nbsp;&nbsp;5&nbsp;&nbsp;5
10&nbsp;&nbsp;1&nbsp;&nbsp;4&nbsp;&nbsp;5&nbsp;&nbsp;1&nbsp;&nbsp;5
20&nbsp;&nbsp;2&nbsp;&nbsp;4&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;1
2&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;4&nbsp;&nbsp;2&nbsp;&nbsp;4&nbsp;&nbsp;1
11&nbsp;&nbsp;3&nbsp;&nbsp;1&nbsp;&nbsp;4&nbsp;&nbsp;4&nbsp;&nbsp;2
16&nbsp;&nbsp;3&nbsp;&nbsp;4&nbsp;&nbsp;1&nbsp;&nbsp;1&nbsp;&nbsp;3
8&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;1&nbsp;&nbsp;1
14&nbsp;&nbsp;4&nbsp;&nbsp;2&nbsp;&nbsp;2&nbsp;&nbsp;3&nbsp;&nbsp;5
18&nbsp;&nbsp;4&nbsp;&nbsp;2&nbsp;&nbsp;3&nbsp;&nbsp;4&nbsp;&nbsp;2
13&nbsp;&nbsp;4&nbsp;&nbsp;2&nbsp;&nbsp;5&nbsp;&nbsp;1&nbsp;&nbsp;1
6&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;2&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;5
7&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;1&nbsp;&nbsp;4&nbsp;&nbsp;2
4&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;2
1&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;4&nbsp;&nbsp;1&nbsp;&nbsp;3&nbsp;&nbsp;4
9&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;5&nbsp;&nbsp;3&nbsp;&nbsp;1&nbsp;&nbsp;2
5&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;2&nbsp;&nbsp;2&nbsp;&nbsp;4&nbsp;&nbsp;3
12&nbsp;&nbsp;5&nbsp;&nbsp;3&nbsp;&nbsp;4&nbsp;&nbsp;2&nbsp;&nbsp;4
15&nbsp;&nbsp;5&nbsp;&nbsp;3&nbsp;&nbsp;5&nbsp;&nbsp;1&nbsp;&nbsp;5
19&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;5&nbsp;&nbsp;1&nbsp;&nbsp;3

</pre>

<div class="p"><!----></div>
Another interesting R function is <tt>Reduce</tt>.  This function 
works with any binary function, that is, one which accepts two arguments, 
and repeatedly applies the binary function until the list is reduced to
a single answer.  One of the most important uses of <tt>Reduce</tt> is
to merge more than two data frames at a time.  Suppose we have three
data frames that we wish to merge:

<pre>
&#62;&nbsp;one&nbsp;=&nbsp;data.frame(id=sample(LETTERS[1:10]),a=rnorm(10))
&#62;&nbsp;two&nbsp;=&nbsp;data.frame(id=sample(LETTERS[1:10]),b=rnorm(10))
&#62;&nbsp;three&nbsp;=&nbsp;data.frame(id=sample(LETTERS[1:10]),c=rnorm(10))

</pre>
Of course, we could call <tt>merge</tt> twice:

<pre>
&#62;&nbsp;both&nbsp;=&nbsp;merge(one,two)
&#62;&nbsp;both&nbsp;=&nbsp;merge(both,three)

</pre>
But what if we had 20 such data frames:

<pre>
&#62;&nbsp;twenty&nbsp;=&nbsp;lapply(letters[1:20],function(i){
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;data.frame(id=sample(LETTERS[1:10]),rnorm(10))
+	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names(z)[2]&nbsp;=&nbsp;i
+	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z})
&#62;&nbsp;twenty[[1]]
&nbsp;&nbsp;&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a
1&nbsp;&nbsp;&nbsp;D&nbsp;&nbsp;1.9112203
2&nbsp;&nbsp;&nbsp;F&nbsp;-0.7198699
3&nbsp;&nbsp;&nbsp;J&nbsp;-0.4290842
4&nbsp;&nbsp;&nbsp;E&nbsp;&nbsp;0.7849467
5&nbsp;&nbsp;&nbsp;B&nbsp;&nbsp;1.5758446
6&nbsp;&nbsp;&nbsp;I&nbsp;&nbsp;0.4998762
7&nbsp;&nbsp;&nbsp;H&nbsp;&nbsp;0.3568294
8&nbsp;&nbsp;&nbsp;A&nbsp;-0.8567896
9&nbsp;&nbsp;&nbsp;G&nbsp;-0.7182695
10&nbsp;&nbsp;C&nbsp;-0.6894396
&#62;&nbsp;twenty[[2]]
&nbsp;&nbsp;&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b
1&nbsp;&nbsp;&nbsp;C&nbsp;&nbsp;2.03416915
2&nbsp;&nbsp;&nbsp;J&nbsp;&nbsp;0.69535618
3&nbsp;&nbsp;&nbsp;E&nbsp;-0.66387813
4&nbsp;&nbsp;&nbsp;H&nbsp;-0.25343952
5&nbsp;&nbsp;&nbsp;D&nbsp;-1.04782198
6&nbsp;&nbsp;&nbsp;G&nbsp;&nbsp;1.56147090
7&nbsp;&nbsp;&nbsp;B&nbsp;-0.28126409
8&nbsp;&nbsp;&nbsp;F&nbsp;-0.30900749
9&nbsp;&nbsp;&nbsp;I&nbsp;&nbsp;0.52277648
10&nbsp;&nbsp;A&nbsp;&nbsp;0.03841634

</pre>
We simply pass <tt>Reduce</tt> the <tt>merge</tt> function and
the list of data frames, and it does the rest:

<pre>
&#62;&nbsp;all&nbsp;=&nbsp;Reduce(merge,twenty)
&nbsp;&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f
1&nbsp;&nbsp;A&nbsp;-0.8567896&nbsp;&nbsp;0.03841634&nbsp;&nbsp;1.1137667&nbsp;-0.6139491&nbsp;-1.2893453&nbsp;&nbsp;0.5760507
2&nbsp;&nbsp;B&nbsp;&nbsp;1.5758446&nbsp;-0.28126409&nbsp;&nbsp;0.2777182&nbsp;-0.1615362&nbsp;&nbsp;0.8221153&nbsp;-0.3328126
3&nbsp;&nbsp;C&nbsp;-0.6894396&nbsp;&nbsp;2.03416915&nbsp;&nbsp;0.6990830&nbsp;&nbsp;0.9430438&nbsp;-0.7059770&nbsp;-0.1309771
4&nbsp;&nbsp;D&nbsp;&nbsp;1.9112203&nbsp;-1.04782198&nbsp;-0.1040303&nbsp;&nbsp;0.2433795&nbsp;&nbsp;0.7645007&nbsp;-0.3161749
5&nbsp;&nbsp;E&nbsp;&nbsp;0.7849467&nbsp;-0.66387813&nbsp;&nbsp;0.0683588&nbsp;-0.5752617&nbsp;-0.4059950&nbsp;-1.2280617
6&nbsp;&nbsp;F&nbsp;-0.7198699&nbsp;-0.30900749&nbsp;-1.0955231&nbsp;-0.8593922&nbsp;&nbsp;0.1585112&nbsp;&nbsp;0.5434146
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m
1&nbsp;&nbsp;1.1469512&nbsp;&nbsp;1.8675396&nbsp;-1.0730001&nbsp;-0.6306937&nbsp;2.5853058&nbsp;&nbsp;0.2524264&nbsp;&nbsp;0.67496861
2&nbsp;&nbsp;0.3483675&nbsp;&nbsp;0.6846907&nbsp;-1.7896035&nbsp;&nbsp;0.7710611&nbsp;1.9890408&nbsp;&nbsp;0.6174135&nbsp;&nbsp;0.16124957
3&nbsp;-0.9972951&nbsp;-0.7140730&nbsp;&nbsp;0.7919375&nbsp;&nbsp;0.3678690&nbsp;1.2336345&nbsp;-0.2323708&nbsp;-0.52465997
4&nbsp;&nbsp;0.1179205&nbsp;-0.1865189&nbsp;-1.0364221&nbsp;&nbsp;0.6013162&nbsp;1.3426701&nbsp;-0.3513651&nbsp;&nbsp;0.48844598
5&nbsp;-0.1171988&nbsp;-0.1514659&nbsp;&nbsp;0.2650891&nbsp;&nbsp;0.1813734&nbsp;0.9233442&nbsp;-1.7945477&nbsp;-0.07855065
6&nbsp;-0.2897749&nbsp;-0.5888773&nbsp;&nbsp;1.8274135&nbsp;-0.3195992&nbsp;0.6230858&nbsp;-0.4897521&nbsp;-0.49559174
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t
1&nbsp;&nbsp;0.5551094&nbsp;&nbsp;1.6335976&nbsp;-1.6149968&nbsp;-0.0601484&nbsp;&nbsp;0.1622304&nbsp;&nbsp;0.1624207&nbsp;-1.1408366
2&nbsp;&nbsp;1.3832478&nbsp;-0.8993505&nbsp;-0.3657969&nbsp;-0.2817061&nbsp;&nbsp;0.2501859&nbsp;-0.2096964&nbsp;-0.5082768
3&nbsp;-0.7369804&nbsp;&nbsp;0.2675346&nbsp;-0.3801290&nbsp;&nbsp;2.2369038&nbsp;&nbsp;1.7701125&nbsp;&nbsp;0.6809073&nbsp;-1.1597869
4&nbsp;&nbsp;1.4028788&nbsp;-0.9317347&nbsp;&nbsp;0.1623700&nbsp;-2.8401085&nbsp;-2.0066582&nbsp;-0.5500940&nbsp;&nbsp;1.9968541
5&nbsp;-0.2516113&nbsp;-1.1269027&nbsp;&nbsp;2.2224559&nbsp;-0.2109566&nbsp;&nbsp;1.6218192&nbsp;-0.7154724&nbsp;&nbsp;1.8204627
6&nbsp;&nbsp;2.0342595&nbsp;-0.1864191&nbsp;-0.7241448&nbsp;&nbsp;1.4295025&nbsp;-2.1206024&nbsp;&nbsp;0.4883462&nbsp;-0.1468977

</pre>

<div class="p"><!----></div>
Another useful R function is <tt>reshape</tt>.  This function reorganizes data
in either the so-called wide or long format.  In the wide format, all observations
for a single individual are recorded in one row of a data frame, while in the 
long view, each observation is a separate row, with an additional variable to 
identify the observation.  For example, here is a data set, in long format, 
representing test scores on several different observations:

<pre>
&#62;&nbsp;data&nbsp;=&nbsp;data.frame(id=rep(1:3,rep(3,3)),time=rep(1:3,3),x=rnorm(9))
&#62;&nbsp;data
&nbsp;&nbsp;id&nbsp;time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x
1&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;-0.85519374
2&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-0.60227681
3&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;0.47671168
4&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;0.28097796
5&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-2.20903570
6&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;0.08311228
7&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;-0.56753562
8&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;0.65588709
9&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;0.42419294

</pre>
 To convert to wide format, the following statements could
be used:

<pre>
&#62;&nbsp;reshape(data,idvar='id',timevar='time',v.names='x',direction='wide')
&nbsp;&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.3
1&nbsp;&nbsp;1&nbsp;-0.8551937&nbsp;-0.6022768&nbsp;0.47671168
4&nbsp;&nbsp;2&nbsp;&nbsp;0.2809780&nbsp;-2.2090357&nbsp;0.08311228
7&nbsp;&nbsp;3&nbsp;-0.5675356&nbsp;&nbsp;0.6558871&nbsp;0.42419294

</pre>
 Notice that not all possible combinations of observations
need to be present:

<pre>
&#62;&nbsp;data1&nbsp;=&nbsp;data[-7,]
&#62;&nbsp;reshape(data1,idvar='id',timevar='time',v.names='x',direction='wide')
&nbsp;&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.3
1&nbsp;&nbsp;1&nbsp;-0.8551937&nbsp;-0.6022768&nbsp;0.47671168
4&nbsp;&nbsp;2&nbsp;&nbsp;0.2809780&nbsp;-2.2090357&nbsp;0.08311228
8&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;0.6558871&nbsp;0.42419294

</pre>
 The missing observations are represented as <tt>NA</tt> in
the output data frame.

<div class="p"><!----></div>
To illustrace the wide-to-long transformation, consider the 
following data:

<pre>
&#62;&nbsp;data&nbsp;=&nbsp;data.frame(id&nbsp;=&nbsp;rep(1:3),x1=c(1,2,3),x2=c(10,20,30),x3=c(100,200,300))
&#62;&nbsp;data
&nbsp;&nbsp;id&nbsp;x1&nbsp;x2&nbsp;&nbsp;x3
1&nbsp;&nbsp;1&nbsp;&nbsp;1&nbsp;10&nbsp;100
2&nbsp;&nbsp;2&nbsp;&nbsp;2&nbsp;20&nbsp;200
3&nbsp;&nbsp;3&nbsp;&nbsp;3&nbsp;30&nbsp;300
&#62;&nbsp;reshape(data,idvar='id',varying=list(c('x1','x2','x3')),direction='long')
&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;time&nbsp;&nbsp;x1
1.1&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1
2.1&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;2
3.1&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;3
1.2&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;10
2.2&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;20
3.2&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;30
1.3&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;100
2.3&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;200
3.3&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;300

</pre>
The trickiest part is noticing that the names of the three varying variables
have to be placed in a list.

<div class="p"><!----></div>
As another example of the use of reshape, consider a study looking at the 
BMI (Body Mass Index) of girls over time,  measured for two different races.
This data can be found in a tab-delimited file at <a href="http://www.stat.berkeley.edu/classes/s133/data/bmi.tab">http://www.stat.berkeley.edu/classes/s133/data/bmi.tab</a>.  The variables in the file are <tt>ID</tt>, <tt>RACE</tt>, <tt>BMI</tt>, and <tt>VISIT</tt>.  Suppose we wish to produce a plot of the average BMI 
versus visit, with separate lines for the two races.  We could use <tt>xyplot</tt> 
from the <tt>lattice</tt> package as follows:

<pre>
&#62;&nbsp;bmi&nbsp;=&nbsp;read.delim('http://www.stat.berkeley.edu/classes/s133/data/bmi.tab')
&#62;&nbsp;avgbmi&nbsp;=&nbsp;aggregate(list(BMI=bmi$BMI),list(Race=bmi$RACE,Visit=bmi$VISIT),
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean,na.rm=TRUE)
&#62;&nbsp;library(lattice)
&#62;&nbsp;xyplot(BMI~Visit,group=Race,type='l',auto.key=TRUE,
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main='BMI&nbsp;vs.&nbsp;Visit',data=avgbmi)

</pre>
 The plot appears below:
<img src="bmi.png">

<div class="p"><!----></div>
Now suppose we wish to calculate the correlations between the BMIs at the 
different visits.  The <tt>cor</tt> function expects all of the variables
for which we want the correlations to be separate columns in the data frame
we pass to the function.  We can rearrange the data to make it suitable
for calculating the correlations by calling <tt>reshape</tt> as follows:

<pre>
&#62;&nbsp;bmi1&nbsp;=&nbsp;reshape(bmi,idvar=c('ID','RACE'),timevar='VISIT',v.names='BMI',
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direction='wide')

</pre>
 We can now calculate the correlations by race:

<pre>
&#62;&nbsp;by(bmi1,bmi1$RACE,function(x)cor(x[,-c(1,2)],use='complete.obs'))
bmi1$RACE:&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.7
BMI.0&nbsp;&nbsp;1.0000000&nbsp;0.9513181&nbsp;0.9238520&nbsp;0.8871666&nbsp;0.8489529&nbsp;0.8227992&nbsp;0.8018502
BMI.2&nbsp;&nbsp;0.9513181&nbsp;1.0000000&nbsp;0.9490917&nbsp;0.9144459&nbsp;0.8625492&nbsp;0.8339581&nbsp;0.8110637
BMI.3&nbsp;&nbsp;0.9238520&nbsp;0.9490917&nbsp;1.0000000&nbsp;0.9517413&nbsp;0.9025264&nbsp;0.8612542&nbsp;0.8327787
BMI.4&nbsp;&nbsp;0.8871666&nbsp;0.9144459&nbsp;0.9517413&nbsp;1.0000000&nbsp;0.9458218&nbsp;0.9054674&nbsp;0.8781602
BMI.5&nbsp;&nbsp;0.8489529&nbsp;0.8625492&nbsp;0.9025264&nbsp;0.9458218&nbsp;1.0000000&nbsp;0.9530917&nbsp;0.9105118
BMI.6&nbsp;&nbsp;0.8227992&nbsp;0.8339581&nbsp;0.8612542&nbsp;0.9054674&nbsp;0.9530917&nbsp;1.0000000&nbsp;0.9568980
BMI.7&nbsp;&nbsp;0.8018502&nbsp;0.8110637&nbsp;0.8327787&nbsp;0.8781602&nbsp;0.9105118&nbsp;0.9568980&nbsp;1.0000000
BMI.8&nbsp;&nbsp;0.7968433&nbsp;0.8026011&nbsp;0.8166798&nbsp;0.8540803&nbsp;0.8859762&nbsp;0.9319712&nbsp;0.9630340
BMI.9&nbsp;&nbsp;0.7888784&nbsp;0.7931164&nbsp;0.8042629&nbsp;0.8351485&nbsp;0.8690846&nbsp;0.9107269&nbsp;0.9316619
BMI.10&nbsp;0.7630397&nbsp;0.7690169&nbsp;0.7777677&nbsp;0.8131666&nbsp;0.8430350&nbsp;0.8803034&nbsp;0.8952306
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.9&nbsp;&nbsp;&nbsp;&nbsp;BMI.10
BMI.0&nbsp;&nbsp;0.7968433&nbsp;0.7888784&nbsp;0.7630397
BMI.2&nbsp;&nbsp;0.8026011&nbsp;0.7931164&nbsp;0.7690169
BMI.3&nbsp;&nbsp;0.8166798&nbsp;0.8042629&nbsp;0.7777677
BMI.4&nbsp;&nbsp;0.8540803&nbsp;0.8351485&nbsp;0.8131666
BMI.5&nbsp;&nbsp;0.8859762&nbsp;0.8690846&nbsp;0.8430350
BMI.6&nbsp;&nbsp;0.9319712&nbsp;0.9107269&nbsp;0.8803034
BMI.7&nbsp;&nbsp;0.9630340&nbsp;0.9316619&nbsp;0.8952306
BMI.8&nbsp;&nbsp;1.0000000&nbsp;0.9596225&nbsp;0.9209648
BMI.9&nbsp;&nbsp;0.9596225&nbsp;1.0000000&nbsp;0.9488572
BMI.10&nbsp;0.9209648&nbsp;0.9488572&nbsp;1.0000000
------------------------------------------------------------&nbsp;
bmi1$RACE:&nbsp;2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.7
BMI.0&nbsp;&nbsp;1.0000000&nbsp;0.9628273&nbsp;0.9281780&nbsp;0.9010607&nbsp;0.8646773&nbsp;0.8410384&nbsp;0.8173900
BMI.2&nbsp;&nbsp;0.9628273&nbsp;1.0000000&nbsp;0.9607964&nbsp;0.9334043&nbsp;0.8940498&nbsp;0.8730059&nbsp;0.8543804
BMI.3&nbsp;&nbsp;0.9281780&nbsp;0.9607964&nbsp;1.0000000&nbsp;0.9656133&nbsp;0.9300707&nbsp;0.9081140&nbsp;0.8886918
BMI.4&nbsp;&nbsp;0.9010607&nbsp;0.9334043&nbsp;0.9656133&nbsp;1.0000000&nbsp;0.9605275&nbsp;0.9378850&nbsp;0.9130036
BMI.5&nbsp;&nbsp;0.8646773&nbsp;0.8940498&nbsp;0.9300707&nbsp;0.9605275&nbsp;1.0000000&nbsp;0.9722481&nbsp;0.9465896
BMI.6&nbsp;&nbsp;0.8410384&nbsp;0.8730059&nbsp;0.9081140&nbsp;0.9378850&nbsp;0.9722481&nbsp;1.0000000&nbsp;0.9751832
BMI.7&nbsp;&nbsp;0.8173900&nbsp;0.8543804&nbsp;0.8886918&nbsp;0.9130036&nbsp;0.9465896&nbsp;0.9751832&nbsp;1.0000000
BMI.8&nbsp;&nbsp;0.8051828&nbsp;0.8423513&nbsp;0.8746659&nbsp;0.8979719&nbsp;0.9293276&nbsp;0.9561339&nbsp;0.9769345
BMI.9&nbsp;&nbsp;0.8003754&nbsp;0.8389726&nbsp;0.8689569&nbsp;0.8868970&nbsp;0.9147281&nbsp;0.9410288&nbsp;0.9582904
BMI.10&nbsp;0.7862279&nbsp;0.8224567&nbsp;0.8464351&nbsp;0.8640517&nbsp;0.8894121&nbsp;0.9157546&nbsp;0.9316408
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BMI.9&nbsp;&nbsp;&nbsp;&nbsp;BMI.10
BMI.0&nbsp;&nbsp;0.8051828&nbsp;0.8003754&nbsp;0.7862279
BMI.2&nbsp;&nbsp;0.8423513&nbsp;0.8389726&nbsp;0.8224567
BMI.3&nbsp;&nbsp;0.8746659&nbsp;0.8689569&nbsp;0.8464351
BMI.4&nbsp;&nbsp;0.8979719&nbsp;0.8868970&nbsp;0.8640517
BMI.5&nbsp;&nbsp;0.9293276&nbsp;0.9147281&nbsp;0.8894121
BMI.6&nbsp;&nbsp;0.9561339&nbsp;0.9410288&nbsp;0.9157546
BMI.7&nbsp;&nbsp;0.9769345&nbsp;0.9582904&nbsp;0.9316408
BMI.8&nbsp;&nbsp;1.0000000&nbsp;0.9767038&nbsp;0.9460700
BMI.9&nbsp;&nbsp;0.9767038&nbsp;1.0000000&nbsp;0.9675484
BMI.10&nbsp;0.9460700&nbsp;0.9675484&nbsp;1.0000000

</pre>
 Not surprisingly, there's a very high correlation between the 
BMI at the different visits for both races.

<div class="p"><!----></div>

<br /><br /><hr /><small>File translated from
T<sub><font size="-1">E</font></sub>X
by <a href="http://hutchinson.belmont.ma.us/tth/">
T<sub><font size="-1">T</font></sub>H</a>,
version 3.67.<br />On 28 Mar 2011, 23:44.</small>
</html>
